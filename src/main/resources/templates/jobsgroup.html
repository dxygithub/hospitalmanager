<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>单位分组</title>
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<meta name="keywords" content="">
		<meta name="description" content="医疗管理系统，为您提供更优质的服务">
		<link rel="stylesheet" href="/css/layui.css">
		<link rel="stylesheet" href="/css/global.css">
		<link rel="stylesheet" href="/css/jobs.css">
	</head>

	<body>
		<script src="/js/nowdate.js" type="text/javascript">
			
		</script>
		<div class="fly-header layui-bg-black">
			<div class="layui-row layui-col-space10">
				<div class="layui-col-md4 layui-col-md-offset5" style="height: 50px;font-size: 26px; line-height: 50px;">
					医疗体检管理系统
				</div>
			</div>
		</div>
		<div class="layui-container layui-row" style="margin-top: 1%;">
			<div class="layui-col-md9">
				欢迎您，尊敬的系统管理员：<label class="username">admin</label>
			</div>
			<div class="layui-col-md3">
				<label id="nowdate"></label>
			</div>
		</div>
		<div class="layui-container fly-marginTop fly-user-main">
			<ul class="layui-nav layui-nav-tree layui-inline" lay-filter="user">
				<!-- 侧边导航: <ul class="layui-nav layui-nav-tree layui-nav-side"> -->
				<li class="layui-nav-item ">
					<a href="javascript:;">体检单位</a>
					<dl class="layui-nav-child units">
						<dd>
							<a href="javascript:;">单位1</a>
							<dl class="layui-nav-child">
								<dd>
									<a href="javascript:;">A组</a>
								</dd>
							</dl>
						</dd>
						<dd>
							<a href="javascript:;">单位1</a>
							<dl class="layui-nav-child">
								<dd>
									<a href="javascript:;">A组</a>
								</dd>
							</dl>
						</dd>
						<dd>
							<a href="javascript:;">单位1</a>
							<dl class="layui-nav-child">
								<dd>
									<a href="javascript:;">A组</a>
								</dd>
							</dl>
						</dd>
					</dl>
				</li>
		
			</ul>

			<div class="site-tree-mobile layui-hide">
				<i class="layui-icon">&#xe602;</i>
			</div>
			<div class="site-mobile-shade"></div>

			<div class="site-tree-mobile layui-hide">
				<i class="layui-icon">&#xe602;</i>
			</div>
			<div class="site-mobile-shade"></div>

			<div class="fly-panel fly-panel-user" pad20>
				<div class="layui-col-md-offset4" style="margin-top: 2%;">
					<h2>体检单位分组信息维护</h2>
				</div>
				<div style="margin-top:2%;">
					<form class="layui-form" action="">
						<input type="hidden" name="unitsId"/>
						<div class="layui-form-item" style="width: 500px;">
							<label class="layui-form-label">单位名称：</label>
							<div class="layui-input-block" style="width: 500px;">
								<input type="text" name="unitsname" required lay-verify="required" readonly="readonly"  autocomplete="off" class="layui-input">
							</div>
						</div>

						<div class="layui-form-item layui-inline" style="width: 400px;">
							<label class="layui-form-label">分组编号：</label>
							<div class="layui-input-block" style="width: 200px;">
								<input type="text" name="unitsGroupId"  readonly="readonly" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item layui-inline" style="width: 400px;">
							<label class="layui-form-label">分组名称：</label>
							<div class="layui-input-block" style="width: 200px;">
								<input type="text" name="groupName" placeholder="请输入分组名称" autocomplete="off" class="layui-input">
							</div>
						</div>

						<div class="layui-form-item">
							<label class="layui-form-label">婚姻状况：</label>
							<div class="layui-input-block">
								<input type="radio" name="maritalCondition" value="0" title="未婚" checked>
								<input type="radio" name="maritalCondition" value="1" title="已婚">
								<input type="radio" name="maritalCondition" value="1" title="不限">
							</div>
						</div>

						<div class="layui-form-item">
							<label class="layui-form-label">性别：</label>
							<div class="layui-input-block">
								<input type="radio" name="sexCondition" value="0" title="男" checked>
								<input type="radio" name="sexCondition" value="1" title="女">
								<input type="radio" name="sexCondition" value="1" title="不限">
							</div>
						</div>

						<div class="layui-form-item layui-inline">
							<div class="layui-inline">
								<label class="layui-form-label">年龄下限：</label>
								<div class="layui-input-block" style="width: 200px;">
									<input type="text" name="ageUpperLimit" placeholder="请输入年龄下限" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-inline">
								<label class="layui-form-label">年龄下限：</label>
								<div class="layui-input-block" style="width: 200px;">
									<input type="text" name="ageLowerLimit" placeholder="请输入年龄下限" autocomplete="off" class="layui-input">
								</div>
							</div>
						</div>

						<div class="layui-form-item" style="width: 500px;">
							<label class="layui-form-label">职务：</label>
							<div class="layui-input-block" style="width: 500px;">
								<input type="text" name="dutyCondition" required lay-verify="required" placeholder="请输入公司职务" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div>
						<div class="layui-form-item">
							<label class="layui-form-label">选择套餐：</label>
							<div class="layui-input-block">
								<select name="package" lay-verify="required">
									<option value=""></option>
									<option value="0">北京</option>
									<option value="1">上海</option>
									<option value="2">广州</option>
									<option value="3">深圳</option>
									<option value="4">杭州</option>
								</select>
							</div>
						</div>
						<div class="layui-input-block" style="border: solid 1px #C9C9C9;overflow:auto; width: 800px; height: 180px;">
								<div style="margin-left:2%;width: 300px; height: 50px; line-height: 50px;">
									<a>第一个体检项</a>
								</div>
								<div style="margin-left:2%;width: 300px; height: 50px; line-height: 50px;">
									<a>第一个体检项</a>
								</div>
								<div style="margin-left:2%;width: 300px; height: 50px; line-height: 50px;">
									<a>第一个体检项</a>
								</div>
								<div style="margin-left:2%;width: 300px; height: 50px; line-height: 50px;">
									<a>第一个体检项</a>
								</div>
								<div style="margin-left:2%;width: 300px; height: 50px; line-height: 50px;">
									<a>第一个体检项</a>
								</div>
								<div style="margin-left:2%;width: 300px; height: 50px; line-height: 50px;">
									<a>第一个体检项</a>
								</div>
								<div style="margin-left:2%;width: 300px; height: 50px; line-height: 50px;">
									<a>第一个体检项</a>
								</div>
								<div style="margin-left:2%;width: 300px; height: 50px; line-height: 50px;">
									<a>第一个体检项</a>
								</div>
								<div style="margin-left:2%;width: 300px; height: 50px; line-height: 50px;">
									<a>第一个体检项</a>
								</div>
							</div>
					</div>

						<div class="layui-form-item">
							<div class="layui-input-block">
								<button class="layui-btn" lay-filter="formDemo" onclick="addUnitsGroup()">保存</button>
							</div>
						</div>
					</form>
					<div class="layui-input-block ss">
						<button class="layui-btn">取消</button>
					</div>
					<div class="layui-input-block ss1">
						<button class="layui-btn">打印</button>
					</div>
					<div class="layui-input-block ss2">
						<button class="layui-btn">退出</button>
					</div>

					
				</div>
			</div>

		</div>

		</div>

		<div class="fly-footer">
			<p>
				<a href="http://fly.layui.com/" target="_blank">医疗体检系统</a> 2018 &copy;
				<a href="http://www.layui.com/" target="_blank">多元合创 出品</a>
			</p>
			<p>
				<a href="http://fly.layui.com/jie/2461/" target="_blank">微信公众号</a>
			</p>
		</div>
		<script src="/layui.js"></script>
		<script src="/js/jobsgroup.js"></script>
		<script src="/js/jquery-3.2.1.js"></script>
		<script>
			var element;
			var form;
            layui.use(['element','form'], function() {
                 element=layui.element,
					 form=layui.form,
                    $=layui.jquery;
                getAllUnits();
                getAllPackage();

                element.init();
            });




			/*$(function () {
                getAllUnits();
            });*/
			

			//获取所有单位信息
			function getAllUnits() {
                $.ajax({
                    url:"/getAllUnits",
                    type:"post",
                    dataType:"json",
                    success:function (data) {
                        var dd="";
                        $.each(data,function (i,e) {
                            dd+="<dd>" +
                                "<a href='javascript:getUnitsGroupInfo(\""+e.unitsId+"\",\""+e.unitsName+"\")' name='"+e.unitsId+"'>"+e.unitsName+"</a>" +
                                "</dd>";
                        });
                        $(".units").html(dd);

                    }
                });
            }

            //根据单位编号获取所有分组信息
            function getUnitsGroupInfo(unitId,unitsName) {
				$.ajax({
					url:"/getAllUnitGroupInfo",
					type:"post",
					data:{"unitId":unitId},
					dataType:"json",
					success:function (data) {
						var dd="";
						$.each(data,function (i,e) {
							dd+="<dl class='layui-nav-child unitgroup'>" +
                                "<dd>" +
                                "<a href='javascript:;'>"+e.groupName+"</a>" +
                                "</dd>" +
                                "</dl>";
                        });
						$(".unitgroup").remove();
						$("a[name='"+unitId+"']").after(dd);
						$("input[name='unitsname']").val(unitsName);
						$("input[name='unitsId']").val(unitId);
                        getNewUnitsGroupId(unitId);
						element.init();
                    }
				});
            }

            //获取当前公司下新的分组编号
            function getNewUnitsGroupId(unitId) {
				$.ajax({
					url:"/getNewUnitGroupId",
					type:"post",
					data:{"UnitId":unitId},
					dataType:"text",
					success:function (data) {
						$("input[name='unitsGroupId']").val(data);
                    }
				});
            }

            //获取所有套餐信息
            function getAllPackage() {
				$.ajax({
					url:"/getAllpackage",
					type:"post",
					dataType:"json",
					success:function (data) {
						var op="<option value='0'>请选择套餐</option>";
						$.each(data,function (i,e) {
							op+="<option value='"+e.packageId+"'>"+e.packageName+"</option>";
                        });
						$("select[name='package']").html(op);

                        form.render();
                    }
				});
            }

			//添加单位分组信息
            function addUnitsGroup() {
				var unitGroupData=$("form").serialize();
				$.ajax({
					url:"/addUnitGroup",
					type:"post",
					data:unitGroupData,
					dataType:"json",
					success:function (data) {
						if(data.stat=="ok"){
							alert("保存成功分组信息!");
						}else {
                            alert("保存失败分组信息!");
						}
                    }
				});
            }


		</script>
	</body>

</html>