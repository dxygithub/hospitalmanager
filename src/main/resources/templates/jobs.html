<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>单位</title>
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<meta name="keywords" content="">
		<meta name="description" content="医疗管理系统，为您提供更优质的服务">
		<link rel="stylesheet" href="/css/layui.css">
		<link rel="stylesheet" href="/css/global.css">
		<link rel="stylesheet" href="/css/jobs.css">
	</head>

	<body>
		<script src="/js/nowdate.js" type="text/javascript">
			
		</script>
		<div class="fly-header layui-bg-black">
			<div class="layui-row layui-col-space10">
				<div class="layui-col-md4 layui-col-md-offset5" style="height: 50px;font-size: 26px; line-height: 50px;">
					医疗体检管理系统
				</div>
			</div>
		</div>
		<div class="layui-container layui-row" style="margin-top: 1%;">
			<div class="layui-col-md9">
				欢迎您，尊敬的系统管理员：<label class="username">admin</label>医生
			</div>
			<div class="layui-col-md3">
				<label id="nowdate"></label>
			</div>
		</div>
		<div class="layui-container fly-marginTop fly-user-main">
			<ul class="layui-nav layui-nav-tree layui-inline" lay-filter="user">
				<!-- 侧边导航: <ul class="layui-nav layui-nav-tree layui-nav-side"> -->
				<li class="layui-nav-item ">
					<a href="javascript:;">体检单位</a>
					<dl class="layui-nav-child units">

						<dd>
							<a href="javascript:;">单位2</a>
						</dd>
						<dd>
							<a href="javascript:;">单位3</a>
						</dd>
					</dl>
				</li>
				
			</ul>

			<div class="site-tree-mobile layui-hide">
				<i class="layui-icon">&#xe602;</i>
			</div>
			<div class="site-mobile-shade"></div>

			<div class="site-tree-mobile layui-hide">
				<i class="layui-icon">&#xe602;</i>
			</div>
			<div class="site-mobile-shade"></div>

			<div class="fly-panel fly-panel-user" pad20>
				<div class="layui-col-md-offset4" style="margin-top: 2%;">
					<h2>体检单位信息维护</h2>
				</div>
				<div style="margin-top:2%;">
					<form class="layui-form">
						<div class="layui-form-item layui-inline" style="width: 400px;">
							<label class="layui-form-label">编号：</label>
							<div class="layui-input-block" style="width: 200px;">
								<input type="text" name="unitsId" placeholder="(只读)" readonly="readonly" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item layui-inline">
							<label class="layui-form-label">是否启用：</label>
							<div class="layui-input-block">
								<input type="radio" name="isdelete" value="0" title="是" checked>
								<input type="radio" name="isdelete" value="1" title="否">
							</div>
						</div>
						<div class="layui-form-item" style="width: 500px;">
							<label class="layui-form-label">单位名称：</label>
							<div class="layui-input-block" style="width: 500px;">
								<input type="text" name="unitsName" required lay-verify="required" placeholder="请输入单位名称" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item layui-inline" style="width: 400px;">
							<label class="layui-form-label">拼音简码：</label>
							<div class="layui-input-block" style="width: 200px;">
								<input type="text" name="spellCode" required lay-verify="required" placeholder="请输入简码" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item layui-inline" style="width: 200px;">
							<label class="layui-form-label">邮政编码：</label>
							<div class="layui-input-block" style="width: 200px;">
								<input type="text" name="postalCode" required lay-verify="required" placeholder="请输入邮政编码" autocomplete="off" class="layui-input">
							</div>
						</div><br />
						<div class="layui-form-item layui-inline" style="width: 400px;">
							<label class="layui-form-label">联系人：</label>
							<div class="layui-input-block" style="width: 200px;">
								<input type="text" name="unitsPrincipal" required lay-verify="required" placeholder="请输入联系人" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item layui-inline" style="width: 200px;">
							<label class="layui-form-label">联系电话：</label>
							<div class="layui-input-block" style="width: 200px;">
								<input type="text" name="telephone" required lay-verify="required" placeholder="请输入联系电话" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item" style="width: 500px;">
							<label class="layui-form-label">联系地址：</label>
							<div class="layui-input-block" style="width: 500px;">
								<input type="text" name="address" required lay-verify="required" placeholder="请输入联系地址" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item" style="width: 500px;">
							<label class="layui-form-label">业务银行：</label>
							<div class="layui-input-block" style="width: 500px;">
								<input type="text" name="businessBank" required lay-verify="required" placeholder="请输入业务银行" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item" style="width: 500px;">
							<label class="layui-form-label">银行账号：</label>
							<div class="layui-input-block" style="width: 500px;">
								<input type="text" name="bankNumber" required lay-verify="required" placeholder="请输入银行账号" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item layui-inline" style="width: 400px;">
							<label class="layui-form-label">企业性质：</label>
							<div class="layui-input-block" style="width: 200px;">
								<input type="text" name="companyNature" required lay-verify="required" placeholder="请输入企业性质" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item layui-inline" style="width: 200px;">
							<label class="layui-form-label">编制人数：</label>
							<div class="layui-input-block" style="width: 200px;">
								<input type="number" name="authorizedNumber" required lay-verify="required" placeholder="请输入编制人数" autocomplete="off" class="layui-input">
							</div>
						</div>
						
						
						
						
						
						<div class="layui-form-item layui-form-text">
							<label class="layui-form-label">备注</label>
							<div class="layui-input-block">
								<textarea name="remark" placeholder="请输入备注内容" class="layui-textarea"></textarea>
							</div>
						</div>

					</form>
					<div class="layui-row" style="text-align: center; margin-left:20%">
						<div class="layui-col-md2">
							<button class="layui-btn" onclick="addUnits()">保存</button>
						</div>
						<div class="layui-col-md2">
							<button class="layui-btn">取消</button>
						</div>
						<div class="layui-col-md2">
							<button class="layui-btn">打印</button>
						</div>
						<div class="layui-col-md2">
							<button class="layui-btn">退出</button>
						</div>
					</div>

				</div>
			</div>

		</div>

		</div>

		<div class="fly-footer">
			<p>
				<a href="http://fly.layui.com/" target="_blank">医疗体检系统</a> 2018 &copy;
				<a href="http://www.layui.com/" target="_blank">多元合创 出品</a>
			</p>
			<p>
				<a href="http://fly.layui.com/jie/2461/" target="_blank">微信公众号</a>
			</p>
		</div>
		<script src="/layui.js"></script>
		<script src="/js/jobs.js"></script>
		<script src="/js/jquery-3.2.1.js"></script>
		<script src="/js/jQuery.Hz2Py-min.js.js"></script>
		<script>
            $(function () {
                getAllUnits();
                getNewUnitId();
                $("input[name='unitsName']").on("keyup keydown change blur", function() {
                    $("input[name='spellCode']").val($(this).toPinyin());
                });
            });

			//获取所有单位信息
			function getAllUnits() {
				$.ajax({
					url:"/getAllUnits",
					type:"post",
					dataType:"json",
					success:function (data) {
                        var dd="";
                        $.each(data,function (i,e) {
                            dd+="<dd>" +
                                "<a href=\"javascript:;\">"+e.unitsName+"</a>" +
                                "</dd>";
                        });
						$(".units").html(dd);
                    }
				});
            }

            //保存公司信息
            function addUnits() {
			    var flag=true;
				var unitData=$("form").serialize();
                $("input").each(function (i,e) {
                    var result=$(e).val();
                    if(result==""){
						flag=false;
						return false;
					}
                });
				if(flag){
                    $.ajax({
                        url:"/addUnits",
                        type:"post",
                        data:unitData,
                        dataType:"json",
                        success:function (data) {
                            if(data.stat=="ok"){
                                alert("保存单位信息成功！");
                                $("input[type='text']").each(function (i,e) {
                                    $(e).val("");
                                });
                                $("textarea").val("");
                                $("input[type='number']").val("");
                                getNewUnitId();
                                getAllUnits();
                            }else {
                                alert("保存单位信息失败！");
                            }
                        }
                    });
				}else {
				    alert("请将公司信息填写完整！");
				}
            }

            //自动获取新的单位编号
            function getNewUnitId() {
				$.ajax({
					url:"/getNewUnitNumber",
					type:"post",
					dataType:"text",
					success:function (data) {
						if(data!=""){
							$("input[name='unitsId']").val(data);
						}
                    }
				});
            }
		</script>
	</body>

</html>